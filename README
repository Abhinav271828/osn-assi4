# Assignment-4 Operating Systems and Networks (IIIT Hyderabad)
# Report

# Specification 1: Syscalls
## `strace`
The `proc.h` file was modified to add a new field, `int strace_m`, to the `proc` structure. This field stores the mask that indicates which syscalls are to be traced; it is initialised to 0 by default in `freeproc()`.

Now, the `sys_trace()` syscall, when called, sets the `strace_m` field of the calling process `p` to its first argument, the mask.

All syscalls have been modified to check the corresponding bit of the `strace_m` field of the calling process and print accordingly, just before they `return`. For example, in the case of `sbrk()`, we have added
```c
if (p->strace_m & (1 << SYS_sbrk))
  printf("%d: syscall sbrk (%d) -> %d\n", p->pid, n, addr);
```

## `sigalarm` (buggy)
`sigalarm()` proceeds by first saving the frequency `n` and the handler `periodic_fn_ptr`, and then saving the trapframe of the calling process. It then acquires the lock of the process, and if its runtime is a multiple of `n`, it changes the instruction pointer of the trapframe to the pointer of the handler.

`sigreturn()`, correspondingly, restores the saved trapframe and increments the instruction pointer so it can continue where it left off.

# Specification 2: Scheduling Algorithms
## First Come First Served
If the `FCFS` macro is defined, the scheduler first makes a pass through the `proc` list to determine the runnable process with the earliest creation time. If no process is runnable, here `to_be_run` remains at its initial value 0 and the function skips all the following steps (effectively, it continues to search `proc[]` for runnable processes).

Once the process is identified, the scheduler acquires its lock and checks if it is still runnable. If it is, it runs it until it stops. At this point, it resets the `proc` field of the CPU and goes back to searching `proc[]` for runnable processes.

Additionally, we ensure that timer-interrupts (in `trap.c`) are checked for *only* when `FCFS` is not the scheduler. This is to avoid preemption.

## Lottery-Based Scheduler

The code in the files that constitute xv6 is
Copyright 2006-2022 Frans Kaashoek, Robert Morris, and Russ Cox.